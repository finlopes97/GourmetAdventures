{% extends 'base.html' %}

{% block content %}
<div class="container-fluid">

    <div class="row mb-4">

        <!-- Event images carousel -->

        <div class="col-12 px-0 shadow">
            <div id="eventImages" class="carousel slide">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#eventImages" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="{{ event.image }}" class="d-block w-100 event-img" alt="...">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#eventImages" data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#eventImages" data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>
        </div>

    </div>

    <div class="row justify-content-center mb-4">
        
        <!-- Event info -->
        <div class="col-sm-7 col-8">
            <div class="p-3 shadow bg-body-tertiary rounded-4">
                <h1>{{ event.title }}</h1>
                <p>{{ event.description }}</p>
                <strong>{{ event.dateTime }}</strong>
                <p>{{ event.locationName }}</p>
            </div>
        </div>

        <div class="col-sm-3 col-4">
            <div class="p-3 shadow bg-body-tertiary rounded-4">
                <h4>${{ event.price }} ea.</h4>
                <p class="text-muted">{{ event.status }}</p>
                <!-- Buy form  -->
                <form method="POST" action="{{ url_for('main.booking', event=event.id) }}" enctype="multipart/form-data">
                    {{ booking_form.csrf_token }}
                    <div class="form-floating mb-1">
                        {{ booking_form.tickets(class="form-control", placeholder="Tickets") }}
                        {{ booking_form.tickets.label }}
                    </div>
                    <div class="d-grid justify-content-end">
                        {{ booking_form.submit(class="btn btn-outline-success btn-sm") }}
                    </div>
                </form>

            </div>
        </div>

    </div>

    <div class="row">
        <div class="col-sm-7 offset-sm-1">
            <div class="p-3 shadow bg-body-tertiary rounded-4">

                <!-- Comment form -->
                <!-- if fails replace with wtf.render_form(form,"/event/{0}/comment".format(event.id)) -->
                <form method="POST" action="{{ url_for('main.comment', event=event.id) }}" enctype="multipart/form-data">
                    {{ comment_form.csrf_token }}
                    <div class="form-floating mb-1">
                        {{ comment_form.content(class="form-control", placeholder="Comment", style="height: 100px") }}
                        {{ comment_form.content.label }}
                    </div>
                    <div class="d-grid justify-content-end">
                        {{ comment_form.submit(class="btn btn-outline-success btn-sm") }}
                    </div>
                </form>

                <!-- Comments -->
                {% for comment in event.comments %}
                <div class="p-2">  
                    <strong>{{comment.user.username}}</strong>
                    <span class="text-muted">&nbsp{{ comment.timestamp.strftime('%Y-%m-%d %H:%M') }}</span>
                    <p>{{ comment.content }}</p>
                </div> 
                {% endfor %}
                
            </div>
        </div>
    </div>

</div>
{% endblock %}